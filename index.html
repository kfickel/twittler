<!DOCTYPE html>

<html>
  <head>
    <title>Twitter</title>
    <link rel="stylesheet" href="style.css">
    <script src="./index_files/jquery.js"></script>
    <script src="./index_files/data_generator.js"></script>
  </head>


  <body>

  <!-- Navigation -->
    <section class="Twittler" id="Twitter">
      <div class="topnav" id="myTopnav">
        <a id="twittlerheader">twittler</a>
        <a id="searchbar">
          <input id="searchbutton" type="submit" value="Go">
          <input id="search" type="text" placeholder="Search tweetles">
        </div>
      
    </section>

    <!--Twittler body-->
    <section id="twittlerbody" >
      <div class="happenings">
        <ul>
          <!--What's Happening-->
          <li id="whatshappening">
             <p>
              <label id="viewpoint">twittler feed</label> 
             </p>
            <div class="update"> 
             <button for="tweetles">tweetles</button>
             <p>
              <li id="tweetles"> 
              </li>
              <li id="specificuser">
              </li>
              <li id="searchresults">
              </li>
             </p> 
            </div> 
              <!--Need to refresh tweetles with each click-->
             </p> 
          </li>
        </ul>  
      </div> 
      <div>  
          <!--user-->
        <ul>  
          <li id="user">
            <p>
              <label for="userheader">Viewing twittler as:</label>
            </p> 
            <p>
              <label for="user">New User</label>
            </p>
            <p> 
              <label for="userhandle">@newuser</label>
            </p>
          </li>
         </ul> 
             

      </div>

    </section>  


    <section>
      <script>

        $(document).ready(function(){
            var $body = $('#tweetles');
            $body.html('');
            var index = streams.home.length - 1;
              while (index >= 0){
               var timestamp = new Date();
               var tweet = streams.home[index];
               var $tweet = $('<p id="tweet"></p>');
               var $twittlename = $('<div class="tweetles" id="username"></div>');
               var $time = $('<p id="time"></p>');
               $tweet.text(tweet.message);
               $time.text('timestamp ' + timestamp.getHours() + ' : ' + timestamp.getMinutes() + ' : ' + timestamp.getSeconds());
               $twittlename.text('@' + tweet.user + ': \n');
               $twittlename.prependTo($body);
               $tweet.appendTo($twittlename);
               $time.appendTo($twittlename);
               index -= 1;
              }              
        });

      </script>
      <script>
      $(document).ready(function() {
        $('.update').on('click', 'button', function(event) {
              $("#viewpoint").text('twittler feed');
              $("#searchresults").empty();
              $("#specificuser").empty();
              $("#tweetles").show();
            }); 
         $(".tweetles#username").on('click', function() {
              var clickedUser = $(this).clone().children().remove().end().text();
              $("#viewpoint").text(clickedUser);
              $(".tweetles#username").each(function(){
                 $(this).addClass($(this).clone().children().remove().end().text());
                  if(clickedUser === $(this).clone().children().remove().end().text()){
                    $(this).clone().appendTo("#specificuser");
                  }
              });
              $('#tweetles').hide();
          });
         $("#searchbutton").on('click', function(){
            $('#tweetles').hide();
            $("#searchresults").empty();
            var searchResult = $('#search').val();
            $(".tweetles#username").each(function(){
              var tweet = $(this).text();
              for(var i = 0; i < tweet.length; i++) {
                var tweetSearch= tweet.slice(i, i + searchResult.length);
                if(tweetSearch === searchResult){
                  console.log(searchResult);
                  $(this).clone().appendTo("#searchresults");
                  i = tweet.length;
                }
              }
            })
         });
      })
      </script>
     </section> 
  </body>
</html>